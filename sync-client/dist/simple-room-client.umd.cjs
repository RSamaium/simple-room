(function(xr,tr){typeof exports=="object"&&typeof module<"u"?tr(exports):typeof define=="function"&&define.amd?define(["exports"],tr):(xr=typeof globalThis<"u"?globalThis:xr||self,tr(xr.SimpleRoom={}))})(this,function(xr){"use strict";var tr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yr={},gt={},Et={},wt={},zr={},_t={},Pn=mt(typeof Buffer<"u"&&Buffer)||mt(tr.Buffer)||mt(typeof window<"u"&&window.Buffer)||tr.Buffer;function mt(r){return r&&r.isBuffer&&r}var kn={}.toString,Bt=Array.isArray||function(r){return kn.call(r)=="[object Array]"},Lr={},Rn={get exports(){return Lr},set exports(r){Lr=r}},ee;function Cn(){if(ee)return Lr;ee=1;var r=Q(),e=Rn.exports=t(0);e.alloc=t,e.concat=r.concat,e.from=n;function t(a){return new Array(a)}function n(a){if(!r.isBuffer(a)&&r.isView(a))a=r.Uint8Array.from(a);else if(r.isArrayBuffer(a))a=new Uint8Array(a);else{if(typeof a=="string")return r.from.call(e,a);if(typeof a=="number")throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(a)}return Lr}var Yr={},On={get exports(){return Yr},set exports(r){Yr=r}},ne;function jn(){if(ne)return Yr;ne=1;var r=Q(),e=r.global,t=On.exports=r.hasBuffer?n(0):[];t.alloc=r.hasBuffer&&e.alloc||n,t.concat=r.concat,t.from=a;function n(o){return new e(o)}function a(o){if(!r.isBuffer(o)&&r.isView(o))o=r.Uint8Array.from(o);else if(r.isArrayBuffer(o))o=new Uint8Array(o);else{if(typeof o=="string")return r.from.call(t,o);if(typeof o=="number")throw new TypeError('"value" argument must not be a number')}return e.from&&e.from.length!==1?e.from(o):new e(o)}return Yr}var Hr={},Dn={get exports(){return Hr},set exports(r){Hr=r}},ie;function Mn(){if(ie)return Hr;ie=1;var r=Q(),e=Dn.exports=r.hasArrayBuffer?t(0):[];e.alloc=t,e.concat=r.concat,e.from=n;function t(a){return new Uint8Array(a)}function n(a){if(r.isView(a)){var o=a.byteOffset,u=a.byteLength;a=a.buffer,a.byteLength!==u&&(a.slice?a=a.slice(o,o+u):(a=new Uint8Array(a),a.byteLength!==u&&(a=Array.prototype.slice.call(a,o,o+u))))}else{if(typeof a=="string")return r.from.call(e,a);if(typeof a=="number")throw new TypeError('"value" argument must not be a number')}return new Uint8Array(a)}return Hr}var Ur={},Vr={};Vr.copy=qn,Vr.toString=Nn,Vr.write=$n;function $n(r,e){for(var t=this,n=e||(e|=0),a=r.length,o=0,u=0;u<a;)o=r.charCodeAt(u++),o<128?t[n++]=o:o<2048?(t[n++]=192|o>>>6,t[n++]=128|o&63):o<55296||o>57343?(t[n++]=224|o>>>12,t[n++]=128|o>>>6&63,t[n++]=128|o&63):(o=(o-55296<<10|r.charCodeAt(u++)-56320)+65536,t[n++]=240|o>>>18,t[n++]=128|o>>>12&63,t[n++]=128|o>>>6&63,t[n++]=128|o&63);return n-e}function Nn(r,e,t){var n=this,a=e|0;t||(t=n.length);for(var o="",u=0;a<t;){if(u=n[a++],u<128){o+=String.fromCharCode(u);continue}(u&224)===192?u=(u&31)<<6|n[a++]&63:(u&240)===224?u=(u&15)<<12|(n[a++]&63)<<6|n[a++]&63:(u&248)===240&&(u=(u&7)<<18|(n[a++]&63)<<12|(n[a++]&63)<<6|n[a++]&63),u>=65536?(u-=65536,o+=String.fromCharCode((u>>>10)+55296,(u&1023)+56320)):o+=String.fromCharCode(u)}return o}function qn(r,e,t,n){var a;t||(t=0),!n&&n!==0&&(n=this.length),e||(e=0);var o=n-t;if(r===this&&t<e&&e<n)for(a=o-1;a>=0;a--)r[a+e]=this[a+t];else for(a=0;a<o;a++)r[a+e]=this[a+t];return o}var ae;function At(){if(ae)return Ur;ae=1;var r=Vr;Ur.copy=o,Ur.slice=u,Ur.toString=l,Ur.write=d("write");var e=Q(),t=e.global,n=e.hasBuffer&&"TYPED_ARRAY_SUPPORT"in t,a=n&&!t.TYPED_ARRAY_SUPPORT;function o(v,s,p,y){var g=e.isBuffer(this),_=e.isBuffer(v);if(g&&_)return this.copy(v,s,p,y);if(!a&&!g&&!_&&e.isView(this)&&e.isView(v)){var U=p||y!=null?u.call(this,p,y):this;return v.set(U,s),U.length}else return r.copy.call(this,v,s,p,y)}function u(v,s){var p=this.slice||!a&&this.subarray;if(p)return p.call(this,v,s);var y=e.alloc.call(this,s-v);return o.call(this,y,0,v,s),y}function l(v,s,p){var y=!n&&e.isBuffer(this)?this.toString:r.toString;return y.apply(this,arguments)}function d(v){return s;function s(){var p=this[v]||r[v];return p.apply(this,arguments)}}return Ur}var oe;function Q(){return oe||(oe=1,function(r){var e=r.global=Pn,t=r.hasBuffer=e&&!!e.isBuffer,n=r.hasArrayBuffer=typeof ArrayBuffer<"u",a=r.isArray=Bt;r.isArrayBuffer=n?U:W;var o=r.isBuffer=t?e.isBuffer:W,u=r.isView=n?ArrayBuffer.isView||ar("ArrayBuffer","buffer"):W;r.alloc=y,r.concat=g,r.from=p;var l=r.Array=Cn(),d=r.Buffer=jn(),v=r.Uint8Array=Mn(),s=r.prototype=At();function p(S){return typeof S=="string"?z.call(this,S):er(this).from(S)}function y(S){return er(this).alloc(S)}function g(S,L){L||(L=0,Array.prototype.forEach.call(S,F));var Y=this!==r&&this||S[0],A=y.call(Y,L),w=0;return Array.prototype.forEach.call(S,h),A;function F(x){L+=x.length}function h(x){w+=s.copy.call(x,A,w)}}var _=ar("ArrayBuffer");function U(S){return S instanceof ArrayBuffer||_(S)}function z(S){var L=S.length*3,Y=y.call(this,L),A=s.write.call(Y,S);return L!==A&&(Y=s.slice.call(Y,0,A)),Y}function er(S){return o(S)?d:u(S)?v:a(S)?l:t?d:n?v:l}function W(){return!1}function ar(S,L){return S="[object "+S+"]",function(Y){return Y!=null&&{}.toString.call(L?Y[L]:Y)===S}}}(_t)),_t}zr.ExtBuffer=Ut;var zn=Q();function Ut(r,e){if(!(this instanceof Ut))return new Ut(r,e);this.buffer=zn.from(r),this.type=e}var St={},fe;function Ln(){if(fe)return St;fe=1,St.setExtPackers=o;var r=Q(),e=r.global,t=r.Uint8Array.from,n,a={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function o(s){s.addExtPacker(14,Error,[v,u]),s.addExtPacker(1,EvalError,[v,u]),s.addExtPacker(2,RangeError,[v,u]),s.addExtPacker(3,ReferenceError,[v,u]),s.addExtPacker(4,SyntaxError,[v,u]),s.addExtPacker(5,TypeError,[v,u]),s.addExtPacker(6,URIError,[v,u]),s.addExtPacker(10,RegExp,[d,u]),s.addExtPacker(11,Boolean,[l,u]),s.addExtPacker(12,String,[l,u]),s.addExtPacker(13,Date,[Number,u]),s.addExtPacker(15,Number,[l,u]),typeof Uint8Array<"u"&&(s.addExtPacker(17,Int8Array,t),s.addExtPacker(18,Uint8Array,t),s.addExtPacker(19,Int16Array,t),s.addExtPacker(20,Uint16Array,t),s.addExtPacker(21,Int32Array,t),s.addExtPacker(22,Uint32Array,t),s.addExtPacker(23,Float32Array,t),typeof Float64Array<"u"&&s.addExtPacker(24,Float64Array,t),typeof Uint8ClampedArray<"u"&&s.addExtPacker(25,Uint8ClampedArray,t),s.addExtPacker(26,ArrayBuffer,t),s.addExtPacker(29,DataView,t)),r.hasBuffer&&s.addExtPacker(27,e,r.from)}function u(s){return n||(n=Pe().encode),n(s)}function l(s){return s.valueOf()}function d(s){s=RegExp.prototype.toString.call(s).split("/"),s.shift();var p=[s.pop()];return p.unshift(s.join("/")),p}function v(s){var p={};for(var y in a)p[y]=s[y];return p}return St}var ue={},Wr={};(function(r){(function(e){var t="undefined",n=t!==typeof Buffer&&Buffer,a=t!==typeof Uint8Array&&Uint8Array,o=t!==typeof ArrayBuffer&&ArrayBuffer,u=[0,0,0,0,0,0,0,0],l=Array.isArray||Y,d=4294967296,v=16777216,s;p("Uint64BE",!0,!0),p("Int64BE",!0,!1),p("Uint64LE",!1,!0),p("Int64LE",!1,!1);function p(A,w,F){var h=w?0:4,x=w?4:0,E=w?0:3,R=w?1:2,N=w?2:1,G=w?3:0,X=w?W:S,vr=w?ar:L,H=fr.prototype,or="is"+A,Pr="_"+or;return H.buffer=void 0,H.offset=0,H[Pr]=!0,H.toNumber=st,H.toString=wr,H.toJSON=st,H.toArray=y,n&&(H.toBuffer=g),a&&(H.toArrayBuffer=_),fr[or]=Mr,e[A]=fr,fr;function fr(T,m,B,I){return this instanceof fr?O(this,T,m,B,I):new fr(T,m,B,I)}function Mr(T){return!!(T&&T[Pr])}function O(T,m,B,I,q){if(a&&o&&(m instanceof o&&(m=new a(m)),I instanceof o&&(I=new a(I))),!m&&!B&&!I&&!s){T.buffer=er(u,0);return}if(!U(m,B)){var nr=s||Array;q=B,I=m,B=0,m=new nr(8)}T.buffer=m,T.offset=B|=0,t!==typeof I&&(typeof I=="string"?ut(m,B,I,q||10):U(I,q)?z(m,B,I,q):typeof q=="number"?(_r(m,B+h,I),_r(m,B+x,q)):I>0?X(m,B,I):I<0?vr(m,B,I):z(m,B,u,0))}function ut(T,m,B,I){var q=0,nr=B.length,ir=0,Z=0;B[0]==="-"&&q++;for(var Yt=q;q<nr;){var ct=parseInt(B[q++],I);if(!(ct>=0))break;Z=Z*I+ct,ir=ir*I+Math.floor(Z/d),Z%=d}Yt&&(ir=~ir,Z?Z=d-Z:ir++),_r(T,m+h,ir),_r(T,m+x,Z)}function st(){var T=this.buffer,m=this.offset,B=ur(T,m+h),I=ur(T,m+x);return F||(B|=0),B?B*d+I:I}function wr(T){var m=this.buffer,B=this.offset,I=ur(m,B+h),q=ur(m,B+x),nr="",ir=!F&&I&2147483648;for(ir&&(I=~I,q=d-q),T=T||10;;){var Z=I%T*d+q;if(I=Math.floor(I/T),q=Math.floor(Z/T),nr=(Z%T).toString(T)+nr,!I&&!q)break}return ir&&(nr="-"+nr),nr}function _r(T,m,B){T[m+G]=B&255,B=B>>8,T[m+N]=B&255,B=B>>8,T[m+R]=B&255,B=B>>8,T[m+E]=B&255}function ur(T,m){return T[m+E]*v+(T[m+R]<<16)+(T[m+N]<<8)+T[m+G]}}function y(A){var w=this.buffer,F=this.offset;return s=null,A!==!1&&F===0&&w.length===8&&l(w)?w:er(w,F)}function g(A){var w=this.buffer,F=this.offset;if(s=n,A!==!1&&F===0&&w.length===8&&Buffer.isBuffer(w))return w;var h=new n(8);return z(h,0,w,F),h}function _(A){var w=this.buffer,F=this.offset,h=w.buffer;if(s=a,A!==!1&&F===0&&h instanceof o&&h.byteLength===8)return h;var x=new a(8);return z(x,0,w,F),x.buffer}function U(A,w){var F=A&&A.length;return w|=0,F&&w+8<=F&&typeof A[w]!="string"}function z(A,w,F,h){w|=0,h|=0;for(var x=0;x<8;x++)A[w++]=F[h++]&255}function er(A,w){return Array.prototype.slice.call(A,w,w+8)}function W(A,w,F){for(var h=w+8;h>w;)A[--h]=F&255,F/=256}function ar(A,w,F){var h=w+8;for(F++;h>w;)A[--h]=-F&255^255,F/=256}function S(A,w,F){for(var h=w+8;w<h;)A[w++]=F&255,F/=256}function L(A,w,F){var h=w+8;for(F++;w<h;)A[w++]=-F&255^255,F/=256}function Y(A){return!!A&&Object.prototype.toString.call(A)=="[object Array]"}})(typeof r.nodeName!="string"?r:tr||{})})(Wr);var se={},Gr={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Gr.read=function(r,e,t,n,a){var o,u,l=a*8-n-1,d=(1<<l)-1,v=d>>1,s=-7,p=t?a-1:0,y=t?-1:1,g=r[e+p];for(p+=y,o=g&(1<<-s)-1,g>>=-s,s+=l;s>0;o=o*256+r[e+p],p+=y,s-=8);for(u=o&(1<<-s)-1,o>>=-s,s+=n;s>0;u=u*256+r[e+p],p+=y,s-=8);if(o===0)o=1-v;else{if(o===d)return u?NaN:(g?-1:1)*(1/0);u=u+Math.pow(2,n),o=o-v}return(g?-1:1)*u*Math.pow(2,o-n)},Gr.write=function(r,e,t,n,a,o){var u,l,d,v=o*8-a-1,s=(1<<v)-1,p=s>>1,y=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,_=n?1:-1,U=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,u=s):(u=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-u))<1&&(u--,d*=2),u+p>=1?e+=y/d:e+=y*Math.pow(2,1-p),e*d>=2&&(u++,d/=2),u+p>=s?(l=0,u=s):u+p>=1?(l=(e*d-1)*Math.pow(2,a),u=u+p):(l=e*Math.pow(2,p-1)*Math.pow(2,a),u=0));a>=8;r[t+g]=l&255,g+=_,l/=256,a-=8);for(u=u<<a|l,v+=a;v>0;r[t+g]=u&255,g+=_,u/=256,v-=8);r[t+g-_]|=U*128};for(var Ft={},Yn=Ft.uint8=new Array(256),Kr=0;Kr<=255;Kr++)Yn[Kr]=Hn(Kr);function Hn(r){return function(e){var t=e.reserve(1);e.buffer[t]=r}}var ce=Gr,le=Wr,Vn=le.Uint64BE,Wn=le.Int64BE,he=Ft.uint8,Zr=Q(),D=Zr.global,Gn=Zr.hasBuffer&&"TYPED_ARRAY_SUPPORT"in D,Kn=Gn&&!D.TYPED_ARRAY_SUPPORT,pe=Zr.hasBuffer&&D.prototype||{};se.getWriteToken=Zn;function Zn(r){return r&&r.uint8array?Jn():Kn||Zr.hasBuffer&&r&&r.safe?Qn():de()}function Jn(){var r=de();return r[202]=C(202,4,ye),r[203]=C(203,8,be),r}function de(){var r=he.slice();return r[196]=Cr(196),r[197]=br(197),r[198]=gr(198),r[199]=Cr(199),r[200]=br(200),r[201]=gr(201),r[202]=C(202,4,pe.writeFloatBE||ye,!0),r[203]=C(203,8,pe.writeDoubleBE||be,!0),r[204]=Cr(204),r[205]=br(205),r[206]=gr(206),r[207]=C(207,8,ve),r[208]=Cr(208),r[209]=br(209),r[210]=gr(210),r[211]=C(211,8,xe),r[217]=Cr(217),r[218]=br(218),r[219]=gr(219),r[220]=br(220),r[221]=gr(221),r[222]=br(222),r[223]=gr(223),r}function Qn(){var r=he.slice();return r[196]=C(196,1,D.prototype.writeUInt8),r[197]=C(197,2,D.prototype.writeUInt16BE),r[198]=C(198,4,D.prototype.writeUInt32BE),r[199]=C(199,1,D.prototype.writeUInt8),r[200]=C(200,2,D.prototype.writeUInt16BE),r[201]=C(201,4,D.prototype.writeUInt32BE),r[202]=C(202,4,D.prototype.writeFloatBE),r[203]=C(203,8,D.prototype.writeDoubleBE),r[204]=C(204,1,D.prototype.writeUInt8),r[205]=C(205,2,D.prototype.writeUInt16BE),r[206]=C(206,4,D.prototype.writeUInt32BE),r[207]=C(207,8,ve),r[208]=C(208,1,D.prototype.writeInt8),r[209]=C(209,2,D.prototype.writeInt16BE),r[210]=C(210,4,D.prototype.writeInt32BE),r[211]=C(211,8,xe),r[217]=C(217,1,D.prototype.writeUInt8),r[218]=C(218,2,D.prototype.writeUInt16BE),r[219]=C(219,4,D.prototype.writeUInt32BE),r[220]=C(220,2,D.prototype.writeUInt16BE),r[221]=C(221,4,D.prototype.writeUInt32BE),r[222]=C(222,2,D.prototype.writeUInt16BE),r[223]=C(223,4,D.prototype.writeUInt32BE),r}function Cr(r){return function(e,t){var n=e.reserve(2),a=e.buffer;a[n++]=r,a[n]=t}}function br(r){return function(e,t){var n=e.reserve(3),a=e.buffer;a[n++]=r,a[n++]=t>>>8,a[n]=t}}function gr(r){return function(e,t){var n=e.reserve(5),a=e.buffer;a[n++]=r,a[n++]=t>>>24,a[n++]=t>>>16,a[n++]=t>>>8,a[n]=t}}function C(r,e,t,n){return function(a,o){var u=a.reserve(e+1);a.buffer[u++]=r,t.call(a.buffer,o,u,n)}}function ve(r,e){new Vn(this,e,r)}function xe(r,e){new Wn(this,e,r)}function ye(r,e){ce.write(this,r,e,!1,23,4)}function be(r,e){ce.write(this,r,e,!1,52,8)}var Xn=Bt,ge=Wr,ri=ge.Uint64BE,ti=ge.Int64BE,Ee=Q(),we=At(),ei=se,ni=Ft.uint8,ii=zr.ExtBuffer,ai=typeof Uint8Array<"u",oi=typeof Map<"u",Sr=[];Sr[1]=212,Sr[2]=213,Sr[4]=214,Sr[8]=215,Sr[16]=216,ue.getWriteType=fi;function fi(r){var e=ei.getWriteToken(r),t=r&&r.useraw,n=ai&&r&&r.binarraybuffer,a=n?Ee.isArrayBuffer:Ee.isBuffer,o=n?L:S,u=oi&&r&&r.usemap,l=u?w:A,d={boolean:v,function:W,number:s,object:t?er:z,string:U(t?_:g),symbol:W,undefined:W};return d;function v(h,x){var E=x?195:194;e[E](h,x)}function s(h,x){var E=x|0,R;if(x!==E){R=203,e[R](h,x);return}else-32<=E&&E<=127?R=E&255:0<=E?R=E<=255?204:E<=65535?205:206:R=-128<=E?208:-32768<=E?209:210;e[R](h,E)}function p(h,x){var E=207;e[E](h,x.toArray())}function y(h,x){var E=211;e[E](h,x.toArray())}function g(h){return h<32?1:h<=255?2:h<=65535?3:5}function _(h){return h<32?1:h<=65535?3:5}function U(h){return x;function x(E,R){var N=R.length,G=5+N*3;E.offset=E.reserve(G);var X=E.buffer,vr=h(N),H=E.offset+vr;N=we.write.call(X,R,H);var or=h(N);if(vr!==or){var Pr=H+or-vr,fr=H+N;we.copy.call(X,X,Pr,H,fr)}var Mr=or===1?160+N:or<=3?215+or:219;e[Mr](E,N),E.offset+=N}}function z(h,x){if(x===null)return W(h,x);if(a(x))return o(h,x);if(Xn(x))return ar(h,x);if(ri.isUint64BE(x))return p(h,x);if(ti.isInt64BE(x))return y(h,x);var E=h.codec.getExtPacker(x);if(E&&(x=E(x)),x instanceof ii)return Y(h,x);l(h,x)}function er(h,x){if(a(x))return F(h,x);z(h,x)}function W(h,x){var E=192;e[E](h,x)}function ar(h,x){var E=x.length,R=E<16?144+E:E<=65535?220:221;e[R](h,E);for(var N=h.codec.encode,G=0;G<E;G++)N(h,x[G])}function S(h,x){var E=x.length,R=E<255?196:E<=65535?197:198;e[R](h,E),h.send(x)}function L(h,x){S(h,new Uint8Array(x))}function Y(h,x){var E=x.buffer,R=E.length,N=Sr[R]||(R<255?199:R<=65535?200:201);e[N](h,R),ni[x.type](h),h.send(E)}function A(h,x){var E=Object.keys(x),R=E.length,N=R<16?128+R:R<=65535?222:223;e[N](h,R);var G=h.codec.encode;E.forEach(function(X){G(h,X),G(h,x[X])})}function w(h,x){if(!(x instanceof Map))return A(h,x);var E=x.size,R=E<16?128+E:E<=65535?222:223;e[R](h,E);var N=h.codec.encode;x.forEach(function(G,X,vr){N(h,X),N(h,G)})}function F(h,x){var E=x.length,R=E<32?160+E:E<=65535?218:219;e[R](h,E),h.send(x)}}var pr={},ui=Bt;pr.createCodec=_e,pr.install=ci,pr.filter=pi;var si=Q();function Fr(r){if(!(this instanceof Fr))return new Fr(r);this.options=r,this.init()}Fr.prototype.init=function(){var r=this.options;return r&&r.uint8array&&(this.bufferish=si.Uint8Array),this};function ci(r){for(var e in r)Fr.prototype[e]=li(Fr.prototype[e],r[e])}function li(r,e){return r&&e?t:r||e;function t(){return r.apply(this,arguments),e.apply(this,arguments)}}function hi(r){return r=r.slice(),function(t){return r.reduce(e,t)};function e(t,n){return n(t)}}function pi(r){return ui(r)?hi(r):r}function _e(r){return new Fr(r)}pr.preset=_e({preset:!0});var me;function Tt(){if(me)return wt;me=1;var r=zr.ExtBuffer,e=Ln(),t=ue,n=pr;n.install({addExtPacker:u,getExtPacker:l,init:o}),wt.preset=o.call(n.preset);function a(d){var v=t.getWriteType(d);return s;function s(p,y){var g=v[typeof y];if(!g)throw new Error('Unsupported type "'+typeof y+'": '+y);g(p,y)}}function o(){var d=this.options;return this.encode=a(d),d&&d.preset&&e.setExtPackers(this),this}function u(d,v,s){s=n.filter(s);var p=v.name;if(p&&p!=="Object"){var y=this.extPackers||(this.extPackers={});y[p]=_}else{var g=this.extEncoderList||(this.extEncoderList=[]);g.unshift([v,_])}function _(U){return s&&(U=s(U)),new r(U,d)}}function l(d){var v=this.extPackers||(this.extPackers={}),s=d.constructor,p=s&&s.name&&v[s.name];if(p)return p;for(var y=this.extEncoderList||(this.extEncoderList=[]),g=y.length,_=0;_<g;_++){var U=y[_];if(s===U[0])return U[1]}}return wt}var Jr={};Jr.FlexDecoder=Tr,Jr.FlexEncoder=Ir;var Or=Q(),di=2048,vi=65536,Be="BUFFER_SHORTAGE";function Tr(){if(!(this instanceof Tr))return new Tr}function Ir(){if(!(this instanceof Ir))return new Ir}Tr.mixin=Se(xi()),Tr.mixin(Tr.prototype),Ir.mixin=Se(yi()),Ir.mixin(Ir.prototype);function xi(){return{bufferish:Or,write:r,fetch:gi,flush:e,push:Ue,pull:Ei,read:Ae,reserve:t,offset:0};function r(n){var a=this.offset?Or.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=a?n?this.bufferish.concat([a,n]):a:n,this.offset=0}function e(){for(;this.offset<this.buffer.length;){var n=this.offset,a;try{a=this.fetch()}catch(o){if(o&&o.message!=Be)throw o;this.offset=n;break}this.push(a)}}function t(n){var a=this.offset,o=a+n;if(o>this.buffer.length)throw new Error(Be);return this.offset=o,a}}function yi(){return{bufferish:Or,write:bi,fetch:r,flush:e,push:Ue,pull:t,read:Ae,reserve:n,send:a,maxBufferSize:vi,minBufferSize:di,offset:0,start:0};function r(){var o=this.start;if(o<this.offset){var u=this.start=this.offset;return Or.prototype.slice.call(this.buffer,o,u)}}function e(){for(;this.start<this.offset;){var o=this.fetch();o&&this.push(o)}}function t(){var o=this.buffers||(this.buffers=[]),u=o.length>1?this.bufferish.concat(o):o[0];return o.length=0,u}function n(o){var u=o|0;if(this.buffer){var l=this.buffer.length,d=this.offset|0,v=d+u;if(v<l)return this.offset=v,d;this.flush(),o=Math.max(o,Math.min(l*2,this.maxBufferSize))}return o=Math.max(o,this.minBufferSize),this.buffer=this.bufferish.alloc(o),this.start=0,this.offset=u,0}function a(o){var u=o.length;if(u>this.minBufferSize)this.flush(),this.push(o);else{var l=this.reserve(u);Or.prototype.copy.call(o,this.buffer,l)}}}function bi(){throw new Error("method not implemented: write()")}function gi(){throw new Error("method not implemented: fetch()")}function Ae(){var r=this.buffers&&this.buffers.length;return r?(this.flush(),this.pull()):this.fetch()}function Ue(r){var e=this.buffers||(this.buffers=[]);e.push(r)}function Ei(){var r=this.buffers||(this.buffers=[]);return r.shift()}function Se(r){return e;function e(t){for(var n in r)t[n]=r[n];return t}}var Fe;function Te(){if(Fe)return Et;Fe=1,Et.EncodeBuffer=t;var r=Tt().preset,e=Jr.FlexEncoder;e.mixin(t.prototype);function t(n){if(!(this instanceof t))return new t(n);if(n&&(this.options=n,n.codec)){var a=this.codec=n.codec;a.bufferish&&(this.bufferish=a.bufferish)}}return t.prototype.codec=r,t.prototype.write=function(n){this.codec.encode(this,n)},Et}var Ie;function Pe(){if(Ie)return gt;Ie=1,gt.encode=e;var r=Te().EncodeBuffer;function e(t,n){var a=new r(n);return a.write(t),a.read()}return gt}var It={},Pt={},kt={},Rt={},ke;function wi(){if(ke)return Rt;ke=1,Rt.setExtUnpackers=a;var r=Q(),e=r.global,t,n={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function a(s){s.addExtUnpacker(14,[o,l(Error)]),s.addExtUnpacker(1,[o,l(EvalError)]),s.addExtUnpacker(2,[o,l(RangeError)]),s.addExtUnpacker(3,[o,l(ReferenceError)]),s.addExtUnpacker(4,[o,l(SyntaxError)]),s.addExtUnpacker(5,[o,l(TypeError)]),s.addExtUnpacker(6,[o,l(URIError)]),s.addExtUnpacker(10,[o,u]),s.addExtUnpacker(11,[o,d(Boolean)]),s.addExtUnpacker(12,[o,d(String)]),s.addExtUnpacker(13,[o,d(Date)]),s.addExtUnpacker(15,[o,d(Number)]),typeof Uint8Array<"u"&&(s.addExtUnpacker(17,d(Int8Array)),s.addExtUnpacker(18,d(Uint8Array)),s.addExtUnpacker(19,[v,d(Int16Array)]),s.addExtUnpacker(20,[v,d(Uint16Array)]),s.addExtUnpacker(21,[v,d(Int32Array)]),s.addExtUnpacker(22,[v,d(Uint32Array)]),s.addExtUnpacker(23,[v,d(Float32Array)]),typeof Float64Array<"u"&&s.addExtUnpacker(24,[v,d(Float64Array)]),typeof Uint8ClampedArray<"u"&&s.addExtUnpacker(25,d(Uint8ClampedArray)),s.addExtUnpacker(26,v),s.addExtUnpacker(29,[v,d(DataView)])),r.hasBuffer&&s.addExtUnpacker(27,d(e))}function o(s){return t||(t=Ye().decode),t(s)}function u(s){return RegExp.apply(null,s)}function l(s){return function(p){var y=new s;for(var g in n)y[g]=p[g];return y}}function d(s){return function(p){return new s(p)}}function v(s){return new Uint8Array(s).buffer}return Rt}var Qr={},Re=Gr,Ce=Wr,Oe=Ce.Uint64BE,je=Ce.Int64BE;Qr.getReadFormat=Bi,Qr.readUint8=De;var Ct=Q(),Xr=At(),_i=typeof Map<"u",mi=!0;function Bi(r){var e=Ct.hasArrayBuffer&&r&&r.binarraybuffer,t=r&&r.int64,n=_i&&r&&r.usemap,a={map:n?Ui:Ai,array:Si,str:Fi,bin:e?Ii:Ti,ext:Pi,uint8:De,uint16:Ri,uint32:Oi,uint64:rt(8,t?$i:Di),int8:ki,int16:Ci,int32:ji,int64:rt(8,t?Ni:Mi),float32:rt(4,qi),float64:rt(8,zi)};return a}function Ai(r,e){var t={},n,a=new Array(e),o=new Array(e),u=r.codec.decode;for(n=0;n<e;n++)a[n]=u(r),o[n]=u(r);for(n=0;n<e;n++)t[a[n]]=o[n];return t}function Ui(r,e){var t=new Map,n,a=new Array(e),o=new Array(e),u=r.codec.decode;for(n=0;n<e;n++)a[n]=u(r),o[n]=u(r);for(n=0;n<e;n++)t.set(a[n],o[n]);return t}function Si(r,e){for(var t=new Array(e),n=r.codec.decode,a=0;a<e;a++)t[a]=n(r);return t}function Fi(r,e){var t=r.reserve(e),n=t+e;return Xr.toString.call(r.buffer,"utf-8",t,n)}function Ti(r,e){var t=r.reserve(e),n=t+e,a=Xr.slice.call(r.buffer,t,n);return Ct.from(a)}function Ii(r,e){var t=r.reserve(e),n=t+e,a=Xr.slice.call(r.buffer,t,n);return Ct.Uint8Array.from(a).buffer}function Pi(r,e){var t=r.reserve(e+1),n=r.buffer[t++],a=t+e,o=r.codec.getExtUnpacker(n);if(!o)throw new Error("Invalid ext type: "+(n&&"0x"+n.toString(16)));var u=Xr.slice.call(r.buffer,t,a);return o(u)}function De(r){var e=r.reserve(1);return r.buffer[e]}function ki(r){var e=r.reserve(1),t=r.buffer[e];return t&128?t-256:t}function Ri(r){var e=r.reserve(2),t=r.buffer;return t[e++]<<8|t[e]}function Ci(r){var e=r.reserve(2),t=r.buffer,n=t[e++]<<8|t[e];return n&32768?n-65536:n}function Oi(r){var e=r.reserve(4),t=r.buffer;return t[e++]*16777216+(t[e++]<<16)+(t[e++]<<8)+t[e]}function ji(r){var e=r.reserve(4),t=r.buffer;return t[e++]<<24|t[e++]<<16|t[e++]<<8|t[e]}function rt(r,e){return function(t){var n=t.reserve(r);return e.call(t.buffer,n,mi)}}function Di(r){return new Oe(this,r).toNumber()}function Mi(r){return new je(this,r).toNumber()}function $i(r){return new Oe(this,r)}function Ni(r){return new je(this,r)}function qi(r){return Re.read(this,r,!1,23,4)}function zi(r){return Re.read(this,r,!1,52,8)}var Me={},Li=Qr;Me.getReadToken=Yi;function Yi(r){var e=Li.getReadFormat(r);return r&&r.useraw?Hi(e):$e(e)}function $e(r){var e,t=new Array(256);for(e=0;e<=127;e++)t[e]=jr(e);for(e=128;e<=143;e++)t[e]=sr(e-128,r.map);for(e=144;e<=159;e++)t[e]=sr(e-144,r.array);for(e=160;e<=191;e++)t[e]=sr(e-160,r.str);for(t[192]=jr(null),t[193]=null,t[194]=jr(!1),t[195]=jr(!0),t[196]=K(r.uint8,r.bin),t[197]=K(r.uint16,r.bin),t[198]=K(r.uint32,r.bin),t[199]=K(r.uint8,r.ext),t[200]=K(r.uint16,r.ext),t[201]=K(r.uint32,r.ext),t[202]=r.float32,t[203]=r.float64,t[204]=r.uint8,t[205]=r.uint16,t[206]=r.uint32,t[207]=r.uint64,t[208]=r.int8,t[209]=r.int16,t[210]=r.int32,t[211]=r.int64,t[212]=sr(1,r.ext),t[213]=sr(2,r.ext),t[214]=sr(4,r.ext),t[215]=sr(8,r.ext),t[216]=sr(16,r.ext),t[217]=K(r.uint8,r.str),t[218]=K(r.uint16,r.str),t[219]=K(r.uint32,r.str),t[220]=K(r.uint16,r.array),t[221]=K(r.uint32,r.array),t[222]=K(r.uint16,r.map),t[223]=K(r.uint32,r.map),e=224;e<=255;e++)t[e]=jr(e-256);return t}function Hi(r){var e,t=$e(r).slice();for(t[217]=t[196],t[218]=t[197],t[219]=t[198],e=160;e<=191;e++)t[e]=sr(e-160,r.bin);return t}function jr(r){return function(){return r}}function K(r,e){return function(t){var n=r(t);return e(t,n)}}function sr(r,e){return function(t){return e(t,r)}}var Ne;function Ot(){if(Ne)return kt;Ne=1;var r=zr.ExtBuffer,e=wi(),t=Qr.readUint8,n=Me,a=pr;a.install({addExtUnpacker:l,getExtUnpacker:d,init:u}),kt.preset=u.call(a.preset);function o(v){var s=n.getReadToken(v);return p;function p(y){var g=t(y),_=s[g];if(!_)throw new Error("Invalid type: "+(g&&"0x"+g.toString(16)));return _(y)}}function u(){var v=this.options;return this.decode=o(v),v&&v.preset&&e.setExtUnpackers(this),this}function l(v,s){var p=this.extUnpackers||(this.extUnpackers=[]);p[v]=a.filter(s)}function d(v){var s=this.extUnpackers||(this.extUnpackers=[]);return s[v]||p;function p(y){return new r(y,v)}}return kt}var qe;function ze(){if(qe)return Pt;qe=1,Pt.DecodeBuffer=t;var r=Ot().preset,e=Jr.FlexDecoder;e.mixin(t.prototype);function t(n){if(!(this instanceof t))return new t(n);if(n&&(this.options=n,n.codec)){var a=this.codec=n.codec;a.bufferish&&(this.bufferish=a.bufferish)}}return t.prototype.codec=r,t.prototype.fetch=function(){return this.codec.decode(this)},Pt}var Le;function Ye(){if(Le)return It;Le=1,It.decode=e;var r=ze().DecodeBuffer;function e(t,n){var a=new r(n);return a.write(t),a.read()}return It}var He={},tt={},Vi={get exports(){return tt},set exports(r){tt=r}};/**
 * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)
 *
 * @copyright Yusuke Kawasaki
 * @license MIT
 * @constructor
 * @see https://github.com/kawanet/event-lite
 * @see http://kawanet.github.io/event-lite/EventLite.html
 * @example
 * var EventLite = require("event-lite");
 *
 * function MyClass() {...}             // your class
 *
 * EventLite.mixin(MyClass.prototype);  // import event methods
 *
 * var obj = new MyClass();
 * obj.on("foo", function() {...});     // add event listener
 * obj.once("bar", function() {...});   // add one-time event listener
 * obj.emit("foo");                     // dispatch event
 * obj.emit("bar");                     // dispatch another event
 * obj.off("foo");                      // remove event listener
 */(function(r){function e(){if(!(this instanceof e))return new e}(function(t){r.exports=t;var n="listeners",a={on:u,once:l,off:d,emit:v};o(t.prototype),t.mixin=o;function o(p){for(var y in a)p[y]=a[y];return p}function u(p,y){return s(this,p).push(y),this}function l(p,y){var g=this;return _.originalListener=y,s(g,p).push(_),g;function _(){d.call(g,p,_),y.apply(this,arguments)}}function d(p,y){var g=this,_;if(!arguments.length)delete g[n];else if(y){if(_=s(g,p,!0),_){if(_=_.filter(U),!_.length)return d.call(g,p);g[n][p]=_}}else if(_=g[n],_&&(delete _[p],!Object.keys(_).length))return d.call(g);return g;function U(z){return z!==y&&z.originalListener!==y}}function v(p,y){var g=this,_=s(g,p,!0);if(!_)return!1;var U=arguments.length;if(U===1)_.forEach(er);else if(U===2)_.forEach(W);else{var z=Array.prototype.slice.call(arguments,1);_.forEach(ar)}return!!_.length;function er(S){S.call(g)}function W(S){S.call(g,y)}function ar(S){S.apply(g,z)}}function s(p,y,g){if(!(g&&!p[n])){var _=p[n]||(p[n]={});return _[y]||(_[y]=[])}}})(e)})(Vi),He.Encoder=Er;var Wi=tt,Ve=Te().EncodeBuffer;function Er(r){if(!(this instanceof Er))return new Er(r);Ve.call(this,r)}Er.prototype=new Ve,Wi.mixin(Er.prototype),Er.prototype.encode=function(r){this.write(r),this.emit("data",this.read())},Er.prototype.end=function(r){arguments.length&&this.encode(r),this.flush(),this.emit("end")};var We={};We.Decoder=dr;var Gi=tt,Ge=ze().DecodeBuffer;function dr(r){if(!(this instanceof dr))return new dr(r);Ge.call(this,r)}dr.prototype=new Ge,Gi.mixin(dr.prototype),dr.prototype.decode=function(r){arguments.length&&this.write(r),this.flush()},dr.prototype.push=function(r){this.emit("data",r)},dr.prototype.end=function(r){this.decode(r),this.emit("end")};var Ke={};Ot(),Tt(),Ke.createCodec=pr.createCodec;var Ze={};Ot(),Tt(),Ze.codec={preset:pr.preset},yr.encode=Pe().encode,yr.decode=Ye().decode,yr.Encoder=He.Encoder,yr.Decoder=We.Decoder,yr.createCodec=Ke.createCodec,yr.codec=Ze.codec;var et={},Ki={get exports(){return et},set exports(r){et=r}};(function(r,e){var t=200,n="__lodash_hash_undefined__",a=800,o=16,u=9007199254740991,l="[object Arguments]",d="[object Array]",v="[object AsyncFunction]",s="[object Boolean]",p="[object Date]",y="[object Error]",g="[object Function]",_="[object GeneratorFunction]",U="[object Map]",z="[object Number]",er="[object Null]",W="[object Object]",ar="[object Proxy]",S="[object RegExp]",L="[object Set]",Y="[object String]",A="[object Undefined]",w="[object WeakMap]",F="[object ArrayBuffer]",h="[object DataView]",x="[object Float32Array]",E="[object Float64Array]",R="[object Int8Array]",N="[object Int16Array]",G="[object Int32Array]",X="[object Uint8Array]",vr="[object Uint8ClampedArray]",H="[object Uint16Array]",or="[object Uint32Array]",Pr=/[\\^$.*+?()[\]{}|]/g,fr=/^\[object .+?Constructor\]$/,Mr=/^(?:0|[1-9]\d*)$/,O={};O[x]=O[E]=O[R]=O[N]=O[G]=O[X]=O[vr]=O[H]=O[or]=!0,O[l]=O[d]=O[F]=O[s]=O[h]=O[p]=O[y]=O[g]=O[U]=O[z]=O[W]=O[S]=O[L]=O[Y]=O[w]=!1;var ut=typeof tr=="object"&&tr&&tr.Object===Object&&tr,st=typeof self=="object"&&self&&self.Object===Object&&self,wr=ut||st||Function("return this")(),_r=e&&!e.nodeType&&e,ur=_r&&!0&&r&&!r.nodeType&&r,T=ur&&ur.exports===_r,m=T&&ut.process,B=function(){try{var i=ur&&ur.require&&ur.require("util").types;return i||m&&m.binding&&m.binding("util")}catch{}}(),I=B&&B.isTypedArray;function q(i,f,c){switch(c.length){case 0:return i.call(f);case 1:return i.call(f,c[0]);case 2:return i.call(f,c[0],c[1]);case 3:return i.call(f,c[0],c[1],c[2])}return i.apply(f,c)}function nr(i,f){for(var c=-1,b=Array(i);++c<i;)b[c]=f(c);return b}function ir(i){return function(f){return i(f)}}function Z(i,f){return i==null?void 0:i[f]}function Yt(i,f){return function(c){return i(f(c))}}var ct=Array.prototype,la=Function.prototype,lt=Object.prototype,Ht=wr["__core-js_shared__"],ht=la.toString,lr=lt.hasOwnProperty,hn=function(){var i=/[^.]+$/.exec(Ht&&Ht.keys&&Ht.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),pn=lt.toString,ha=ht.call(Object),pa=RegExp("^"+ht.call(lr).replace(Pr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pt=T?wr.Buffer:void 0,dn=wr.Symbol,vn=wr.Uint8Array,xn=pt?pt.allocUnsafe:void 0,yn=Yt(Object.getPrototypeOf,Object),bn=Object.create,da=lt.propertyIsEnumerable,va=ct.splice,mr=dn?dn.toStringTag:void 0,dt=function(){try{var i=Gt(Object,"defineProperty");return i({},"",{}),i}catch{}}(),xa=pt?pt.isBuffer:void 0,gn=Math.max,ya=Date.now,En=Gt(wr,"Map"),$r=Gt(Object,"create"),ba=function(){function i(){}return function(f){if(!Ar(f))return{};if(bn)return bn(f);i.prototype=f;var c=new i;return i.prototype=void 0,c}}();function Br(i){var f=-1,c=i==null?0:i.length;for(this.clear();++f<c;){var b=i[f];this.set(b[0],b[1])}}function ga(){this.__data__=$r?$r(null):{},this.size=0}function Ea(i){var f=this.has(i)&&delete this.__data__[i];return this.size-=f?1:0,f}function wa(i){var f=this.__data__;if($r){var c=f[i];return c===n?void 0:c}return lr.call(f,i)?f[i]:void 0}function _a(i){var f=this.__data__;return $r?f[i]!==void 0:lr.call(f,i)}function ma(i,f){var c=this.__data__;return this.size+=this.has(i)?0:1,c[i]=$r&&f===void 0?n:f,this}Br.prototype.clear=ga,Br.prototype.delete=Ea,Br.prototype.get=wa,Br.prototype.has=_a,Br.prototype.set=ma;function hr(i){var f=-1,c=i==null?0:i.length;for(this.clear();++f<c;){var b=i[f];this.set(b[0],b[1])}}function Ba(){this.__data__=[],this.size=0}function Aa(i){var f=this.__data__,c=vt(f,i);if(c<0)return!1;var b=f.length-1;return c==b?f.pop():va.call(f,c,1),--this.size,!0}function Ua(i){var f=this.__data__,c=vt(f,i);return c<0?void 0:f[c][1]}function Sa(i){return vt(this.__data__,i)>-1}function Fa(i,f){var c=this.__data__,b=vt(c,i);return b<0?(++this.size,c.push([i,f])):c[b][1]=f,this}hr.prototype.clear=Ba,hr.prototype.delete=Aa,hr.prototype.get=Ua,hr.prototype.has=Sa,hr.prototype.set=Fa;function kr(i){var f=-1,c=i==null?0:i.length;for(this.clear();++f<c;){var b=i[f];this.set(b[0],b[1])}}function Ta(){this.size=0,this.__data__={hash:new Br,map:new(En||hr),string:new Br}}function Ia(i){var f=yt(this,i).delete(i);return this.size-=f?1:0,f}function Pa(i){return yt(this,i).get(i)}function ka(i){return yt(this,i).has(i)}function Ra(i,f){var c=yt(this,i),b=c.size;return c.set(i,f),this.size+=c.size==b?0:1,this}kr.prototype.clear=Ta,kr.prototype.delete=Ia,kr.prototype.get=Pa,kr.prototype.has=ka,kr.prototype.set=Ra;function Rr(i){var f=this.__data__=new hr(i);this.size=f.size}function Ca(){this.__data__=new hr,this.size=0}function Oa(i){var f=this.__data__,c=f.delete(i);return this.size=f.size,c}function ja(i){return this.__data__.get(i)}function Da(i){return this.__data__.has(i)}function Ma(i,f){var c=this.__data__;if(c instanceof hr){var b=c.__data__;if(!En||b.length<t-1)return b.push([i,f]),this.size=++c.size,this;c=this.__data__=new kr(b)}return c.set(i,f),this.size=c.size,this}Rr.prototype.clear=Ca,Rr.prototype.delete=Oa,Rr.prototype.get=ja,Rr.prototype.has=Da,Rr.prototype.set=Ma;function $a(i,f){var c=Jt(i),b=!c&&Zt(i),k=!c&&!b&&An(i),j=!c&&!b&&!k&&Sn(i),M=c||b||k||j,P=M?nr(i.length,String):[],$=P.length;for(var rr in i)(f||lr.call(i,rr))&&!(M&&(rr=="length"||k&&(rr=="offset"||rr=="parent")||j&&(rr=="buffer"||rr=="byteLength"||rr=="byteOffset")||mn(rr,$)))&&P.push(rr);return P}function Vt(i,f,c){(c!==void 0&&!bt(i[f],c)||c===void 0&&!(f in i))&&Wt(i,f,c)}function Na(i,f,c){var b=i[f];(!(lr.call(i,f)&&bt(b,c))||c===void 0&&!(f in i))&&Wt(i,f,c)}function vt(i,f){for(var c=i.length;c--;)if(bt(i[c][0],f))return c;return-1}function Wt(i,f,c){f=="__proto__"&&dt?dt(i,f,{configurable:!0,enumerable:!0,value:c,writable:!0}):i[f]=c}var qa=ro();function xt(i){return i==null?i===void 0?A:er:mr&&mr in Object(i)?to(i):fo(i)}function wn(i){return Nr(i)&&xt(i)==l}function za(i){if(!Ar(i)||ao(i))return!1;var f=Xt(i)?pa:fr;return f.test(lo(i))}function La(i){return Nr(i)&&Un(i.length)&&!!O[xt(i)]}function Ya(i){if(!Ar(i))return oo(i);var f=Bn(i),c=[];for(var b in i)b=="constructor"&&(f||!lr.call(i,b))||c.push(b);return c}function _n(i,f,c,b,k){i!==f&&qa(f,function(j,M){if(k||(k=new Rr),Ar(j))Ha(i,f,M,c,_n,b,k);else{var P=b?b(Kt(i,M),j,M+"",i,f,k):void 0;P===void 0&&(P=j),Vt(i,M,P)}},Fn)}function Ha(i,f,c,b,k,j,M){var P=Kt(i,c),$=Kt(f,c),rr=M.get($);if(rr){Vt(i,c,rr);return}var J=j?j(P,$,c+"",i,f,M):void 0,qr=J===void 0;if(qr){var re=Jt($),te=!re&&An($),In=!re&&!te&&Sn($);J=$,re||te||In?Jt(P)?J=P:ho(P)?J=Ja(P):te?(qr=!1,J=Ga($,!0)):In?(qr=!1,J=Za($,!0)):J=[]:po($)||Zt($)?(J=P,Zt(P)?J=vo(P):(!Ar(P)||Xt(P))&&(J=eo($))):qr=!1}qr&&(M.set($,J),k(J,$,b,j,M),M.delete($)),Vt(i,c,J)}function Va(i,f){return so(uo(i,f,Tn),i+"")}var Wa=dt?function(i,f){return dt(i,"toString",{configurable:!0,enumerable:!1,value:yo(f),writable:!0})}:Tn;function Ga(i,f){if(f)return i.slice();var c=i.length,b=xn?xn(c):new i.constructor(c);return i.copy(b),b}function Ka(i){var f=new i.constructor(i.byteLength);return new vn(f).set(new vn(i)),f}function Za(i,f){var c=f?Ka(i.buffer):i.buffer;return new i.constructor(c,i.byteOffset,i.length)}function Ja(i,f){var c=-1,b=i.length;for(f||(f=Array(b));++c<b;)f[c]=i[c];return f}function Qa(i,f,c,b){var k=!c;c||(c={});for(var j=-1,M=f.length;++j<M;){var P=f[j],$=b?b(c[P],i[P],P,c,i):void 0;$===void 0&&($=i[P]),k?Wt(c,P,$):Na(c,P,$)}return c}function Xa(i){return Va(function(f,c){var b=-1,k=c.length,j=k>1?c[k-1]:void 0,M=k>2?c[2]:void 0;for(j=i.length>3&&typeof j=="function"?(k--,j):void 0,M&&no(c[0],c[1],M)&&(j=k<3?void 0:j,k=1),f=Object(f);++b<k;){var P=c[b];P&&i(f,P,b,j)}return f})}function ro(i){return function(f,c,b){for(var k=-1,j=Object(f),M=b(f),P=M.length;P--;){var $=M[i?P:++k];if(c(j[$],$,j)===!1)break}return f}}function yt(i,f){var c=i.__data__;return io(f)?c[typeof f=="string"?"string":"hash"]:c.map}function Gt(i,f){var c=Z(i,f);return za(c)?c:void 0}function to(i){var f=lr.call(i,mr),c=i[mr];try{i[mr]=void 0;var b=!0}catch{}var k=pn.call(i);return b&&(f?i[mr]=c:delete i[mr]),k}function eo(i){return typeof i.constructor=="function"&&!Bn(i)?ba(yn(i)):{}}function mn(i,f){var c=typeof i;return f=f??u,!!f&&(c=="number"||c!="symbol"&&Mr.test(i))&&i>-1&&i%1==0&&i<f}function no(i,f,c){if(!Ar(c))return!1;var b=typeof f;return(b=="number"?Qt(c)&&mn(f,c.length):b=="string"&&f in c)?bt(c[f],i):!1}function io(i){var f=typeof i;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?i!=="__proto__":i===null}function ao(i){return!!hn&&hn in i}function Bn(i){var f=i&&i.constructor,c=typeof f=="function"&&f.prototype||lt;return i===c}function oo(i){var f=[];if(i!=null)for(var c in Object(i))f.push(c);return f}function fo(i){return pn.call(i)}function uo(i,f,c){return f=gn(f===void 0?i.length-1:f,0),function(){for(var b=arguments,k=-1,j=gn(b.length-f,0),M=Array(j);++k<j;)M[k]=b[f+k];k=-1;for(var P=Array(f+1);++k<f;)P[k]=b[k];return P[f]=c(M),q(i,this,P)}}function Kt(i,f){if(!(f==="constructor"&&typeof i[f]=="function")&&f!="__proto__")return i[f]}var so=co(Wa);function co(i){var f=0,c=0;return function(){var b=ya(),k=o-(b-c);if(c=b,k>0){if(++f>=a)return arguments[0]}else f=0;return i.apply(void 0,arguments)}}function lo(i){if(i!=null){try{return ht.call(i)}catch{}try{return i+""}catch{}}return""}function bt(i,f){return i===f||i!==i&&f!==f}var Zt=wn(function(){return arguments}())?wn:function(i){return Nr(i)&&lr.call(i,"callee")&&!da.call(i,"callee")},Jt=Array.isArray;function Qt(i){return i!=null&&Un(i.length)&&!Xt(i)}function ho(i){return Nr(i)&&Qt(i)}var An=xa||bo;function Xt(i){if(!Ar(i))return!1;var f=xt(i);return f==g||f==_||f==v||f==ar}function Un(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=u}function Ar(i){var f=typeof i;return i!=null&&(f=="object"||f=="function")}function Nr(i){return i!=null&&typeof i=="object"}function po(i){if(!Nr(i)||xt(i)!=W)return!1;var f=yn(i);if(f===null)return!0;var c=lr.call(f,"constructor")&&f.constructor;return typeof c=="function"&&c instanceof c&&ht.call(c)==ha}var Sn=I?ir(I):La;function vo(i){return Qa(i,Fn(i))}function Fn(i){return Qt(i)?$a(i,!0):Ya(i)}var xo=Xa(function(i,f,c,b){_n(i,f,c,b)});function yo(i){return function(){return i}}function Tn(i){return i}function bo(){return!1}r.exports=xo})(Ki,et);var jt=function(r,e){return jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},jt(r,e)};function Dr(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");jt(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Dt(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nt(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),a,o=[],u;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)o.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(u)throw u.error}}return o}function it(r,e,t){if(t||arguments.length===2)for(var n=0,a=e.length,o;n<a;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))}function cr(r){return typeof r=="function"}function Je(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Mt=Je(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,a){return a+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function $t(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var at=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,a,o;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var l=Dt(u),d=l.next();!d.done;d=l.next()){var v=d.value;v.remove(this)}}catch(U){e={error:U}}finally{try{d&&!d.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else u.remove(this);var s=this.initialTeardown;if(cr(s))try{s()}catch(U){o=U instanceof Mt?U.errors:[U]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var y=Dt(p),g=y.next();!g.done;g=y.next()){var _=g.value;try{rn(_)}catch(U){o=o??[],U instanceof Mt?o=it(it([],nt(o)),nt(U.errors)):o.push(U)}}}catch(U){n={error:U}}finally{try{g&&!g.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}}if(o)throw new Mt(o)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)rn(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&$t(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&$t(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}(),Qe=at.EMPTY;function Xe(r){return r instanceof at||r&&"closed"in r&&cr(r.remove)&&cr(r.add)&&cr(r.unsubscribe)}function rn(r){cr(r)?r():r.unsubscribe()}var tn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Nt={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var a=Nt.delegate;return a!=null&&a.setTimeout?a.setTimeout.apply(a,it([r,e],nt(t))):setTimeout.apply(void 0,it([r,e],nt(t)))},clearTimeout:function(r){var e=Nt.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(r)},delegate:void 0};function Zi(r){Nt.setTimeout(function(){throw r})}function en(){}function ot(r){r()}var nn=function(r){Dr(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Xe(t)&&t.add(n)):n.destination=ra,n}return e.create=function(t,n,a){return new zt(t,n,a)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(at),Ji=Function.prototype.bind;function qt(r,e){return Ji.call(r,e)}var Qi=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){ft(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){ft(n)}else ft(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){ft(t)}},r}(),zt=function(r){Dr(e,r);function e(t,n,a){var o=r.call(this)||this,u;if(cr(t)||!t)u={next:t??void 0,error:n??void 0,complete:a??void 0};else{var l;o&&tn.useDeprecatedNextContext?(l=Object.create(t),l.unsubscribe=function(){return o.unsubscribe()},u={next:t.next&&qt(t.next,l),error:t.error&&qt(t.error,l),complete:t.complete&&qt(t.complete,l)}):u=t}return o.destination=new Qi(u),o}return e}(nn);function ft(r){Zi(r)}function Xi(r){throw r}var ra={closed:!0,next:en,error:Xi,complete:en},ta=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ea(r){return r}function na(r){return r.length===0?ea:r.length===1?r[0]:function(t){return r.reduce(function(n,a){return a(n)},t)}}var an=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var a=this,o=aa(e)?e:new zt(e,t,n);return ot(function(){var u=a,l=u.operator,d=u.source;o.add(l?l.call(o,d):d?a._subscribe(o):a._trySubscribe(o))}),o},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=on(t),new t(function(a,o){var u=new zt({next:function(l){try{e(l)}catch(d){o(d),u.unsubscribe()}},error:o,complete:a});n.subscribe(u)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[ta]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return na(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=on(e),new e(function(n,a){var o;t.subscribe(function(u){return o=u},function(u){return a(u)},function(){return n(o)})})},r.create=function(e){return new r(e)},r}();function on(r){var e;return(e=r??tn.Promise)!==null&&e!==void 0?e:Promise}function ia(r){return r&&cr(r.next)&&cr(r.error)&&cr(r.complete)}function aa(r){return r&&r instanceof nn||ia(r)&&Xe(r)}var oa=Je(function(r){return function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),fn=function(r){Dr(e,r);function e(){var t=r.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var n=new un(this,this);return n.operator=t,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new oa},e.prototype.next=function(t){var n=this;ot(function(){var a,o;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var u=Dt(n.currentObservers),l=u.next();!l.done;l=u.next()){var d=l.value;d.next(t)}}catch(v){a={error:v}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}})},e.prototype.error=function(t){var n=this;ot(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=t;for(var a=n.observers;a.length;)a.shift().error(t)}})},e.prototype.complete=function(){var t=this;ot(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var n=t.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var n=this,a=this,o=a.hasError,u=a.isStopped,l=a.observers;return o||u?Qe:(this.currentObservers=null,l.push(t),new at(function(){n.currentObservers=null,$t(l,t)}))},e.prototype._checkFinalizedStatuses=function(t){var n=this,a=n.hasError,o=n.thrownError,u=n.isStopped;a?t.error(o):u&&t.complete()},e.prototype.asObservable=function(){var t=new an;return t.source=this,t},e.create=function(t,n){return new un(t,n)},e}(an),un=function(r){Dr(e,r);function e(t,n){var a=r.call(this)||this;return a.destination=t,a.source=n,a}return e.prototype.next=function(t){var n,a;(a=(n=this.destination)===null||n===void 0?void 0:n.next)===null||a===void 0||a.call(n,t)},e.prototype.error=function(t){var n,a;(a=(n=this.destination)===null||n===void 0?void 0:n.error)===null||a===void 0||a.call(n,t)},e.prototype.complete=function(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)},e.prototype._subscribe=function(t){var n,a;return(a=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&a!==void 0?a:Qe},e}(fn),sn=function(r){Dr(e,r);function e(t){var n=r.call(this)||this;return n._value=t,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var n=r.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},e.prototype.getValue=function(){var t=this,n=t.hasError,a=t.thrownError,o=t._value;if(n)throw a;return this._throwIfClosed(),o},e.prototype.next=function(t){r.prototype.next.call(this,this._value=t)},e}(fn);let fa=Symbol("clean"),V=[];const cn=((r,e)=>{let t,n=[],a={lc:0,l:e||0,value:r,set(o){a.value=o,a.notify()},get(){return a.lc||a.listen(()=>{})(),a.value},notify(o){t=n;let u=!V.length;for(let l=0;l<t.length;l+=2)V.push(t[l],a.value,o,t[l+1]);if(u){for(let l=0;l<V.length;l+=4){let d=!1;for(let v=l+7;v<V.length;v+=4)if(V[v]<V[l+3]){d=!0;break}d?V.push(V[l],V[l+1],V[l+2],V[l+3]):V[l](V[l+1],V[l+2])}V.length=0}},listen(o,u){return n===t&&(n=n.slice()),a.lc=n.push(o,u||a.l)/2,()=>{n===t&&(n=n.slice());let l=n.indexOf(o);~l&&(n.splice(l,2),a.lc--,a.lc||a.off())}},subscribe(o,u){let l=a.listen(o,u);return o(a.value),l},off(){}};return{}.NODE_ENV!=="production"&&(a[fa]=()=>{n=[],a.lc=0,a.off()}),a})({});class ua{constructor(e){this.collectionClass=e,this.collection=new Map,this.removeCb=t=>{},this.addCb=(t,n)=>{}}registerRemoveCallback(e){this.removeCb=e}registerAddCallback(e){this.addCb=e}detectChanges(e){let t={};for(let n in e){const a=e[n];if(a==null){this.collection.delete(n),this.removeCb(n);continue}const o=this.collectionClass?new this.collectionClass(a,n):a;this.collection.has(n)||this.addCb(n,o),this.collection.set(n,o),t[n]=o}return t}}class sa{constructor(e,t){this.id=t,Object.assign(this,e)}isMe(){return Lt.userId==this.id}}const ln=class{constructor(){this.obs$=new sn({}),this.users=new ua(sa)}get value(){return this.obs$.asObservable()}join(r){this.socket.emit(":join",r)}input(r,e){return this.socket.emit(":input",{prop:r,value:e}),{catchError:t=>this.socket.once(":error",t)}}action(r,e){return this.socket.emit(":action",{name:r,value:e}),{catchError:t=>this.socket.once(":error",t)}}listen(r,e={}){return e.encoded===void 0&&(e.encoded=!0),this.socket=r,this.socket.on("uid",t=>{ln.userId=t}),this.socket.on("connect",()=>{this.obs$.next({})}),this.socket.on("w",t=>{if(e.encoded){const v=new Uint8Array(t);t=yr.decode(v)}const[n,a,o]=t,u=this.obs$.value.roomId;let l={},d=[];u==n?(o.join=!1,l=et({...this.obs$.value.data||{}},o,(v,s,p,y,g,_)=>{if(s!=null&&typeof s=="object"){if(Object.values(s).length==0)return{};if(s.$reset)return d.push(p),delete s.$reset,s}})):l=o,o.users&&(l.users=this.users.detectChanges(l.users)),this.obs$.next({roomId:n,data:l,partial:o,time:a,resetProps:d}),cn.set({...l})}),this}reset(){this.obs$=new sn({})}};let Lt=ln;Lt.userId=null;const ca=new Lt;xr.World=ca,xr.room=cn,Object.defineProperty(xr,Symbol.toStringTag,{value:"Module"})});
